REM Create the SLN file 
"%UE_PATH%%UE_VERSION%/Engine/Binaries/DotNet/UnrealBuildTool/UnrealBuildTool.exe" -projectfiles -project="%WORKSPACE%/Santa_Trackers/Santa_Trackers.uproject" -progress



REM Execute the RunUAT with Build Cook Run 
"%UE_PATH%%UE_VERSION%/Engine/Build/BatchFiles/RunUAT.bat" -ScriptsForProject="%WORKSPACE%/Santa_Trackers/Santa_Trackers.uproject" BuildCookRun -project="%WORKSPACE%/Santa_Trackers/Santa_Trackers.uproject" -noP4 -clientconfig=%BUILD_CFG% -serverconfig=%BUILD_CFG% -installed -unrealexe="%UE_PATH%%UE_VERSION%\Engine\Binaries\Win64\UnrealEditor-Cmd.exe" -utf8output -platform=Win64 -build -cook -map=ExteriorHouse+Overview+Room+DemoMap+Area_51+Bedroom+ExteriorHouse+LivingRoom+Upstairs_Hallway -CookCultures=en -unversionedcookedcontent -zenstore -pak -stage -compressed -cookincremental -stage -package -stagingdirectory="%WORKSPACE%/Santa_Trackers/Export/Windows" -cmdline="ExteriorHouse -Messaging"

REM rename the deploy directory
ren "%WORKSPACE%/Santa_Trackers/Export/Windows" "Santa_Trackers-%PROJECT_VERSION%-%BUILD_NUMBER"


REM Rename build folder
ren "%WORKSPACE%\Santa_Trackers\Export\Windows" "Santa_Trackers-%PROJECT_VERSION%-%BUILD_NUMBER%" if errorlevel 1 exit /b 1

REM Archive the build
"C:/Program Files/7-Zip/7z.exe" a -t7z
"%WORKSPACE%/Santa_Trackers/Export/Windows/Santa_Trackers-Windows-%PROJECT_VERSION%-%BUILD_NUMBER%.rar"
"%WORKSPACE%/Santa_Trackers/Export/Windows/Santa_Trackers-%PROJECT_VERSION%-%BUILD_NUMBER%." -xr!*.pdb


REM Archive build
"C:\Program Files\7-Zip\7z.exe" a -t7z ^ "%WORKSPACE%\Santa_Trackers\Export\Santa_Trackers-%PROJECT_VERSION%-%BUILD_NUMBER%.7z" ^ "%WORKSPACE%\Santa_Trackers\Export\Santa_Trackers-%PROJECT_VERSION%-%BUILD_NUMBER%\*" ^ -xr!*.pdb if errorlevel 1 exit /b 1